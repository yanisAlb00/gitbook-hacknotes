# Buffer Overflows

A buffer is a memory area intended to hold content that is often sent by user for later processing.

2 main types of buffers :

* Buffers with dynamic size
* Buffers with fixed preallocated size

## Buffer Overflow

If a developer allocates X size of memory for a variable which is supplied by a user and the user can submit a size > to X without validation it could lead to Buffer Overflow.

```c
#include <stdio.h>
#include <string.h>
int main(int argc, char *argv[]) {
 int value = 5;
 char buffer_one[8], buffer_two[8];
 strcpy(buffer_one, "one"); /* Put "one" into buffer_one. */
 strcpy(buffer_two, "two"); /* Put "two" into buffer_two. */
 printf("[BEFORE] buffer_two is at %p and contains \'%s\'\n", buffer_two, buffer_two);
 printf("[BEFORE] buffer_one is at %p and contains \'%s\'\n", buffer_one, buffer_one);
 printf("[BEFORE] value is at %p and is %d (0x%08x)\n", &value, value, value);
 printf("\n[STRCPY] copying %d bytes into buffer_two\n\n", strlen(argv[1]));
 strcpy(buffer_two, argv[1]); /* Copy first argument into buffer_two. */
 printf("[AFTER] buffer_two is at %p and contains \'%s\'\n", buffer_two, buffer_two);
 printf("[AFTER] buffer_one is at %p and contains \'%s\'\n", buffer_one, buffer_one);
 printf("[AFTER] value is at %p and is %d (0x%08x)\n", &value, value, value);
}
```

If the user submits :&#x20;

```
./overflow_example 1234567890
```

The result will be :&#x20;

```
reader@hacking:~/booksrc $ ./overflow_example 1234567890
[BEFORE] buffer_two is at 0xbffff7f0 and contains 'two'
[BEFORE] buffer_one is at 0xbffff7f8 and contains 'one'
[BEFORE] value is at 0xbffff804 and is 5 (0x00000005)
[STRCPY] copying 10 bytes into buffer_two
[AFTER] buffer_two is at 0xbffff7f0 and contains '1234567890'
[AFTER] buffer_one is at 0xbffff7f8 and contains '90'
[AFTER] value is at 0xbffff804 and is 5 (0x00000005)
```

\-> Buffer overflow in buffer\_one memory address because the address is located after buffer\_two
